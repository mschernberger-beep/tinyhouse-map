<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smi´s Tiny House – Interaktive Karte Ebensee</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    :root {
      --blue-900: #1a365d;
      --blue-700: #1e40af;
      --blue-200: #dce4ec;
      --sand-50: #f8fafc;
      --border: #cbd5e1;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: "Inter", "Arial", sans-serif;
      background: var(--sand-50);
      color: #0f172a;
    }

    header {
      padding: 18px 16px 8px;
    }

    h1 {
      margin: 0;
      color: var(--blue-900);
      font-size: 28px;
      line-height: 1.2;
    }

    .subtitle {
      margin: 4px 0 0;
      color: #334155;
      font-size: 15px;
    }

    .hero-link {
      color: var(--blue-700);
      text-decoration: none;
      font-weight: 600;
    }

    .hero-link:hover { text-decoration: underline; }

    #map-wrapper {
      position: relative;
      margin: 0 12px 16px;
      border: 1px solid var(--border);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 6px 16px rgba(15, 23, 42, 0.08);
      background: #fff;
    }

    #map { height: 72vh; width: 100%; }

    #filters {
      padding: 12px;
      background: #eff4fb;
      border-bottom: 1px solid var(--border);
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .filter-btn {
      background: var(--blue-200);
      padding: 6px 12px;
      border-radius: 20px;
      border: 1px solid #b9c6d3;
      cursor: pointer;
      font-size: 14px;
      color: #0f172a;
      transition: all 0.15s ease;
      user-select: none;
    }

    .filter-btn:hover { filter: brightness(0.97); }

    .filter-btn.active {
      background: var(--blue-700);
      border-color: var(--blue-700);
      color: white;
      box-shadow: 0 4px 10px rgba(30, 64, 175, 0.3);
    }

    #tiny-reset-btn {
      position: absolute;
      top: 14px;
      right: 14px;
      z-index: 1000;
      background: white;
      border-radius: 50%;
      width: 52px;
      height: 52px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.18);
      border: 2px solid var(--blue-700);
      cursor: pointer;
      transition: transform 0.15s ease;
    }

    #tiny-reset-btn:hover { transform: translateY(-1px); }

    #tiny-reset-btn img { width: 28px; height: 28px; }

    .leaflet-popup-content-wrapper { border-radius: 12px; }

    .popup-title {
      margin: 0 0 6px;
      color: var(--blue-900);
      font-size: 16px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .tiny-pill {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: #fde68a;
      color: #92400e;
      border-radius: 10px;
      padding: 2px 8px;
      font-size: 12px;
      border: 1px solid #fbbf24;
    }

    .popup-desc { margin: 0 0 8px; }

    .popup-cats { display: flex; flex-wrap: wrap; gap: 6px; }

    .badge {
      background: #e2e8f0;
      border-radius: 10px;
      padding: 2px 8px;
      font-size: 12px;
      color: #0f172a;
    }

    .popup-link a {
      color: var(--blue-700);
      font-weight: 600;
      text-decoration: none;
    }

    .popup-link a:hover { text-decoration: underline; }

    @media (max-width: 768px) {
      h1 { font-size: 23px; }
      #map { height: 68vh; }
      #map-wrapper { margin: 0 8px 14px; }
      #tiny-reset-btn { width: 46px; height: 46px; top: 12px; right: 12px; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Erkundungen ab <a class="hero-link" href="https://www.smis-tiny-house.com" target="_blank" rel="noopener">Smi´s Tiny House</a></h1>
    <p class="subtitle">Der perfekte Ausgangspunkt am Traunsee für Wandern, Baden & Ausflüge.</p>
  </header>

  <div id="map-wrapper">
    <div id="filters"></div>
    <div id="map"></div>
    <div id="tiny-reset-btn" title="Zurück zum Tiny House">
      <img src="https://cdn-icons-png.flaticon.com/512/3917/3917215.png" alt="Tiny House Icon" />
    </div>
  </div>

  <script>
    const Icons = {
      tiny: new L.Icon({
        iconUrl: 'https://cdn-icons-png.flaticon.com/512/3917/3917215.png',
        iconSize: [38, 38],
        iconAnchor: [19, 38]
      }),
      wandern: new L.Icon({
        iconUrl: 'https://cdn-icons-png.flaticon.com/512/684/684908.png',
        iconSize: [32, 32],
        iconAnchor: [16, 32]
      }),
      see: new L.Icon({
        iconUrl: 'https://cdn-icons-png.flaticon.com/512/427/427735.png',
        iconSize: [32, 32],
        iconAnchor: [16, 32]
      }),
      essen: new L.Icon({
        iconUrl: 'https://cdn-icons-png.flaticon.com/512/3075/3075977.png',
        iconSize: [32, 32],
        iconAnchor: [16, 32]
      }),
      kultur: new L.Icon({
        iconUrl: 'https://cdn-icons-png.flaticon.com/512/3448/3448636.png',
        iconSize: [32, 32],
        iconAnchor: [16, 32]
      }),
      sport: new L.Icon({
        iconUrl: 'https://cdn-icons-png.flaticon.com/512/854/854878.png',
        iconSize: [32, 32],
        iconAnchor: [16, 32]
      })
    };

    const tinyHouse = {
      lat: 47.792130,
      lng: 13.760837,
      name: "Smi´s Tiny House",
      cats: ["Tiny House"],
      desc: "Dein gemütliches Tiny House in Ebensee – der Startpunkt für alle Erlebnisse.",
      link: "https://www.smis-tiny-house.com",
      icon: Icons.tiny,
      isTiny: true
    };

    const pois = [
      tinyHouse,
      { lat: 47.808333, lng: 13.775000, name: "Ortszentrum Ebensee / Rathausplatz", cats: ["Ausflug", "Kultur"], desc: "Zentrum von Ebensee mit Cafés und Einkaufsmöglichkeiten.", icon: Icons.kultur },
      { lat: 47.809360, lng: 13.789990, name: "Strandbad Ebensee", cats: ["See", "Familie"], desc: "Öffentliches Strandbad direkt am Traunsee.", icon: Icons.see },
      { lat: 47.809480, lng: 13.789720, name: "Freizeitanlage Rindbach", cats: ["See", "Familie"], desc: "Liegewiese, Sportplatz & Grillzonen.", icon: Icons.see },
      { lat: 47.803127, lng: 13.797915, name: "Parkplatz Rindbach Wasserfall", cats: ["Wandern", "Ausflug"], desc: "Startpunkt zum Wasserfall Rindbach.", icon: Icons.wandern },
      { lat: 47.813056, lng: 13.758333, name: "Feuerkogel-Seilbahn Talstation", cats: ["Wandern", "Ausflug"], desc: "Auffahrt in die Bergwelt des Feuerkogels.", icon: Icons.wandern },
      { lat: 47.816667, lng: 13.716667, name: "Feuerkogel Bergstation", cats: ["Wandern", "Familie"], desc: "Panorama, Rundwege und Almhütten.", icon: Icons.wandern },
      { lat: 47.834500, lng: 13.688900, name: "Langbathsee Parkplatz", cats: ["See", "Wandern"], desc: "Startpunkt der Langbathseen-Runde.", icon: Icons.wandern },
      { lat: 47.837111, lng: 13.700542, name: "Signalkogel Einstieg", cats: ["Wandern"], desc: "Einstieg in den Signalkogel-Rundweg.", icon: Icons.wandern },
      { lat: 47.756949, lng: 13.844605, name: "Parkplatz Offensee", cats: ["See", "Wandern"], desc: "Natursee mit Rundwanderung.", icon: Icons.wandern },
      { lat: 47.800023, lng: 13.766891, name: "Karthalle Ebensee", cats: ["Sport", "Familie"], desc: "Indoor Kartbahn für Groß & Klein.", icon: Icons.sport },
      { lat: 47.765350, lng: 13.715324, name: "Naturmuseum Salzkammergut", cats: ["Ausflug", "Familie"], desc: "Museum rund um Flora & Fauna.", icon: Icons.kultur },
      { lat: 47.807431, lng: 13.774185, name: "Kino Ebensee", cats: ["Kultur"], desc: "Kulturverein & Programmkino.", icon: Icons.kultur },
      { lat: 47.812722, lng: 13.777250, name: "Segelclub Ebensee", cats: ["Sport", "See"], desc: "Segelrevier am Traunsee.", icon: Icons.sport },
      { lat: 47.823056, lng: 13.842778, name: "Gassel-Tropfsteinhöhle", cats: ["Wandern", "Ausflug"], desc: "Höhlenwanderung mit Führung.", icon: Icons.wandern },
      { lat: 47.800433, lng: 13.777856, name: "Hotel Hochsteg Gütl", cats: ["Essen", "Ausflug"], desc: "Gastronomie & Wellness in Ebensee.", icon: Icons.essen },
      { lat: 47.814208, lng: 13.762970, name: "Gasthof Roitner", cats: ["Essen"], desc: "Regionale Küche in Seenähe.", icon: Icons.essen }
    ];

    const map = L.map('map', {
      zoomControl: true,
      scrollWheelZoom: true
    }).setView([tinyHouse.lat, tinyHouse.lng], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution:'© OpenStreetMap' }).addTo(map);

    let markerLayer = L.layerGroup().addTo(map);

    const categorySet = new Set();
    pois.forEach(p => p.cats.forEach(c => { if(c !== "Tiny House") categorySet.add(c); }));
    const categories = Array.from(categorySet).sort();

    const filterDiv = document.getElementById('filters');
    let activeCats = [];

    const allBtn = document.createElement('div');
    allBtn.className = 'filter-btn active';
    allBtn.textContent = 'Alle Aktivitäten';
    allBtn.onclick = () => {
      activeCats = [];
      document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
      allBtn.classList.add('active');
      renderMarkers();
    };
    filterDiv.appendChild(allBtn);

    categories.forEach(cat => {
      const btn = document.createElement('div');
      btn.className = 'filter-btn';
      btn.textContent = cat;
      btn.onclick = () => {
        allBtn.classList.remove('active');
        if (activeCats.includes(cat)) {
          activeCats = activeCats.filter(c => c !== cat);
          btn.classList.remove('active');
        } else {
          activeCats.push(cat);
          btn.classList.add('active');
        }
        if (activeCats.length === 0) allBtn.classList.add('active');
        renderMarkers();
      };
      filterDiv.appendChild(btn);
    });

    function buildPopup(poi) {
      const catBadges = poi.cats.map(c => `<span class="badge">${c}</span>`).join('');
      const tinyLabel = poi.isTiny ? '<span class="tiny-pill">Ausgangspunkt</span>' : '';
      const linkRow = poi.link ? `<div class="popup-link"><a href="${poi.link}" target="_blank" rel="noopener">Website öffnen</a></div>` : '';
      return `
        <h3 class="popup-title">${poi.name} ${tinyLabel}</h3>
        <p class="popup-desc">${poi.desc}</p>
        <div class="popup-cats">${catBadges}</div>
        ${linkRow}
      `;
    }

    function renderMarkers(){
      markerLayer.clearLayers();
      const latLngs = [];
      pois.forEach(p => {
        const inFilter = activeCats.length === 0 || p.cats.some(c => activeCats.includes(c)) || p.isTiny;
        if (!inFilter) return;

        const marker = L.marker([p.lat, p.lng], { icon: p.icon }).addTo(markerLayer);
        marker.bindPopup(buildPopup(p));

        if (p.isTiny) {
          L.circleMarker([p.lat, p.lng], { radius: 12, color: '#f97316', fillColor: '#fb923c', fillOpacity: 0.8, weight: 2 }).addTo(markerLayer);
        }

        latLngs.push([p.lat, p.lng]);
      });

      if (latLngs.length > 0) {
        const bounds = L.latLngBounds(latLngs);
        map.fitBounds(bounds, { padding: [24, 24] });
      }
    }

    renderMarkers();

    const resetBtn = document.getElementById('tiny-reset-btn');
    resetBtn.addEventListener('click', () => {
      map.setView([tinyHouse.lat, tinyHouse.lng], 14);
      markerLayer.eachLayer(layer => {
        if (layer.getLatLng && layer.getLatLng().lat === tinyHouse.lat && layer.getLatLng().lng === tinyHouse.lng) {
          layer.openPopup();
        }
      });
    });
  </script>
</body>
</html>
